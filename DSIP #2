for exercises from https://discuss.codecademy.com/t/data-science-independent-project-2-explore-a-sample-database/419945
using .db file here https://www.sqlitetutorial.net/sqlite-sample-database/

--BASIC
--#1 Which tracks appeared in the most playlists? how many playlist did they appear in?

----to count by trackid

select name, count(trackid)
from (
	select * from tracks
	left join playlist_track
	on tracks.trackid = playlist_track.TrackId
	)
group by trackid
order by count(trackid) desc;

---- to count by track title (some have duplicate trackid values)

select name, count(name)
from (
	select * from tracks
	left join playlist_track
	on tracks.trackid = playlist_track.TrackId
	)
group by name
order by count(name) desc;

--#2 Which track generated the most revenue? which album? which genre?

-- Revenues by track name (some have multiple trackid values)

select tracks.trackid, tracks.name, (invoice_items.UnitPrice*count(invoice_items.Quantity)) as revenues from invoice_items
left join tracks
on invoice_items.TrackId = tracks.TrackId
group by tracks.name
order by revenues desc, tracks.trackid ASC
limit 10

-- Revenues by trackid

select tracks.trackid, tracks.name, (invoice_items.UnitPrice*count(invoice_items.Quantity)) as revenues from invoice_items
left join tracks
on invoice_items.TrackId = tracks.TrackId
group by tracks.trackid
order by revenues desc, tracks.trackid ASC
limit 10

-- Revenues by Album Title

select albums. albumid, albums.title, (invoice_items.UnitPrice * count(invoice_items.quantity)) as revenues from invoice_items
left join tracks
on invoice_items.trackid = tracks.trackid
left join albums
on tracks.AlbumId = albums.albumid 
group by albums.title
order by revenues DESC
limit 10

-- Revenues by Genre
